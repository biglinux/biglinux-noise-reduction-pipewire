context.modules = [
    {
        name = libpipewire-module-filter-chain
        args = {
            "node.description" = "Noise Canceling Microphone"
            "media.name" = "Noise Canceling Microphone"
            "filter.graph" = {
                "nodes" = [
                    {
                        type = ladspa
                        name = "rnnoise"
                        plugin = "/usr/lib/ladspa/librnnoise_ladspa_big.so"
                        label = "noise_suppressor_mono"
                        control = {
                            "VAD Threshold (%)" = 85.0
                            "VAD Grace Period (ms)" = 200
                            "Retroactive VAD Grace (ms)" = 30
                        }
                        audio.rate = 48000
                        audio.channels = 1
                    },
                    {
                        type = ladspa
                        name = "gate"
                        plugin = "/usr/lib/ladspa/gate_1410.so"
                        label = "gate"
                        control = {
                            "Threshold (dB)" = -10
                            "Attack (ms)" = 10
                            "Hold (ms)" = 200
                            "Decay (ms)" = 60
                            "Range (dB)" = -6
                        }
                        audio.rate = 48000
                        audio.channels = 1
                    },
                    {
                        type = ladspa
                        name = "compressor"
                        plugin = "/usr/lib/ladspa/sc4_1882.so"
                        label = "sc4"
                        control = {
                            "RMS/peak" = 0.0
                            "Attack time (ms)" = 60.0
                            "Release time (ms)" = 600.0
                            "Threshold level (dB)" = -12.0
                            "Ratio (1:n)" = 12.0
                            "Knee radius (dB)" = 2.0
                            "Makeup gain (dB)" = 12.0
                        }
                        audio.rate = 48000
                        audio.channels = 1
                    },
                    {
                        type = ladspa
                        name = "limiter"
                        plugin = "/usr/lib/ladspa/fast_lookahead_limiter_1913.so"
                        label = "fastLookaheadLimiter"
                        control = {
                            "Input gain (dB)" = 6.0
                            "Limit (dB)" = -6.0
                            "Release time (s)" = 0.8
                        }
                        audio.rate = 48000
                        audio.channels = 1
                    }
                ]
                "links" = [
                    { output = "rnnoise:Output" input = "gate:Input" },
                    { output = "gate:Output" input = "compressor:Left input" },
                    { output = "compressor:Left output" input = "limiter:Input 1" }
                ]
                "inputs" = [ "rnnoise:Input" ]
                "outputs" = [ "limiter:Output 1" ]
            }
            "audio.channels" = 1
            "capture.props" = {
                "node.passive" = true
            }
            "playback.props" = {
                "filter.smart" = true
                "media.class" = "Audio/Source"
                "filter.smart.name" = "big.filter-microphone"
            }
        }
    }
]
